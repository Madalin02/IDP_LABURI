' Gambas class file

Public gameWindow As New Window As "gameWindow"  ' Changed from screen to gameWindow
Public imgX As Integer
Public imgY As Integer

Public Struct Star
  x As Integer
  y As Integer
  speed As Integer
End Struct

Private Starfield As New Star[]
Private img As Image
Private rotation As Integer = 0

Public Sub _new()
  Dim i As Integer
  Dim stars As Star
  
  Randomize
  
  With gameWindow    ' Changed from screen to gameWindow
    .Resizable = False
    .Show()
  End With
  
  imgX = gameWindow.Width - 128   ' Changed from screen to gameWindow
  imgY = gameWindow.Height - 128  ' Changed from screen to gameWindow
  img = Image.Load("constitution-pilot.png")
  
  For i = 0 To 100
    Stars = New Star
    Stars.x = Int(Rnd(gameWindow.Width))    ' Changed from Screen to gameWindow
    Stars.y = Int(Rnd(gameWindow.Height))   ' Changed from screen to gameWindow
    Stars.speed = Int(Rnd(1, 4))
    Starfield.Push(stars)
  Next
End

Public Sub gameWindow_draw()    ' Changed from screen_draw to gameWindow_draw
  Dim Stars As Star
  gameWindow.Clear()           ' Changed from screen to gameWindow
  
  For Each Stars In Starfield
    Draw.ForeColor = &h444444& * Stars.speed
    Draw.Line(Stars.x, Stars.y, Stars.x + (Stars.speed * 2), stars.y)
    Stars.x += Stars.speed
    
    If Stars.x > gameWindow.Width Then    ' Changed from screen to gameWindow
      Stars.x = 0
      Stars.y = Int(Rnd(gameWindow.Height))   ' Changed from screen to gameWindow
      Stars.speed = Int(Rnd(1, 4))
    Endif
  Next
  
  Draw.ForeColor = &hFFFFFF&
  Draw.Text(gameWindow.Framerate, 10, gameWindow.Height - 40)   ' Changed from Screen to gameWindow
  Draw.Rotate(rotation)
  Draw.Image(img, imgX, imgY)
  rotation = (rotation + 1) Mod 360
End

Public Sub gameWindow_KeyPress()    ' Changed from screen_KeyPress to gameWindow_KeyPress
  Print "Key Press"
  Select Case Key.Code
    Case Key.Up
      If imgY >= 10 Then
        imgY -= 10
      Endif
    Case Key.Left
      If imgX >= 10 Then
        imgX -= 10
      Endif
    Case Key.Down
      If imgY < gameWindow.Height - 10    ' Changed from screen to gameWindow
        imgY += 10
      Endif
    Case Key.Right
      If imgX < gameWindow.Width - 10     ' Changed from screen to gameWindow
        imgX += 10
      Endif
  End Select
End
